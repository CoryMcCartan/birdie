<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Bayesian models for accurately estimating conditional distributions by race, using Bayesian Improved Surname Geocoding (BISG) probability estimates of individual race. Implements the methods described in McCartan, Fisher, Goldin, Ho and Imai (2024) &lt;doi:10.3386/w32373&gt;.">
<title>Bayesian Instrumental Regression for Disparity Estimation • birdie</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Instrumental Regression for Disparity Estimation">
<meta property="og:description" content="Bayesian models for accurately estimating conditional distributions by race, using Bayesian Improved Surname Geocoding (BISG) probability estimates of individual race. Implements the methods described in McCartan, Fisher, Goldin, Ho and Imai (2024) &lt;doi:10.3386/w32373&gt;.">
<meta property="og:image" content="http://corymccartan.com/birdie/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2KH5JZ6JS1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2KH5JZ6JS1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">birdie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/birdie.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CoryMcCartan/birdie/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="birdie-estimating-disparities-when-race-is-not-observed-">
<strong>BIRDiE</strong>: Estimating disparities when race is not observed <a class="anchor" aria-label="anchor" href="#birdie-estimating-disparities-when-race-is-not-observed-"></a>
</h1>
</div>
<!-- badges: start -->

<p>Bayesian Instrumental Regression for Disparity Estimation (BIRDiE) is a class of Bayesian models for accurately estimating conditional distributions by race, using Bayesian Improved Surname Geocoding (BISG) probability estimates of individual race. This package implements BIRDiE as described in <a href="https://www.nber.org/papers/w32373" class="external-link">McCartan, Fisher, Goldin, Ho, and Imai (2024)</a>. It also implements standard BISG and an improved measurement-error BISG model as described in <a href="https://www.science.org/doi/full/10.1126/sciadv.adc9824" class="external-link">Imai, Olivella, and Rosenman (2022)</a>.</p>
<p><img src="reference/figures/poster.svg" style="width: 100%" alt="BIRDiE Overview Poster"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of the package from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"birdie"</span><span class="op">)</span></span></code></pre></div>
<p>You can also install the development version with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"CoryMcCartan/birdie"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>A basic analysis has two steps. First, you compute BISG probability estimates with the <code><a href="reference/bisg.html">bisg()</a></code> or <code><a href="reference/bisg.html">bisg_me()</a></code> functions (or using any other probabilistic race prediction tool). Then, you estimate the distribution of an outcome variable by race using the <code><a href="reference/birdie.html">birdie()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CoryMcCartan/birdie" class="external-link">birdie</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pseudo_vf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pseudo_vf</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   last_name zip   race  turnout</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  </span></span>
<span><span class="co">#&gt; 1 BEAVER    28748 white yes    </span></span>
<span><span class="co">#&gt; 2 WILLIAMS  28144 black no     </span></span>
<span><span class="co">#&gt; 3 ROSEN     28270 white yes    </span></span>
<span><span class="co">#&gt; 4 SMITH     28677 black yes    </span></span>
<span><span class="co">#&gt; 5 FAY       28748 white no     </span></span>
<span><span class="co">#&gt; 6 CHURCH    28215 white yes</span></span></code></pre></div>
<p>To compute BISG probabilities, you provide the last name and (optionally) geography variables as part of a formula.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_probs</span> <span class="op">=</span> <span class="fu"><a href="reference/bisg.html">bisg</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">nm</span><span class="op">(</span><span class="va">last_name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/utils/zip.html" class="external-link">zip</a></span><span class="op">(</span><span class="va">zip</span><span class="op">)</span>, data<span class="op">=</span><span class="va">pseudo_vf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">r_probs</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span><span class="co">#&gt;   pr_white pr_black pr_hisp pr_asian  pr_aian pr_other</span></span>
<span><span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1    0.956  0.00371  0.0103 0.000674 0.00886    0.0202</span></span>
<span><span class="co">#&gt; 2    0.162  0.795    0.0122 0.00102  0.000873   0.0292</span></span>
<span><span class="co">#&gt; 3    0.943  0.00378  0.0218 0.0107   0.000386   0.0202</span></span>
<span><span class="co">#&gt; 4    0.569  0.365    0.0302 0.00114  0.00108    0.0339</span></span>
<span><span class="co">#&gt; 5    0.971  0.00118  0.0131 0.00149  0.00118    0.0125</span></span>
<span><span class="co">#&gt; 6    0.524  0.315    0.0909 0.00598  0.00255    0.0610</span></span></code></pre></div>
<p>Computing regression estimates requires specifying a model structure. Here, we’ll use a Categorical-Dirichlet regression model that lets the relationship between turnout and race vary by ZIP code. This is the “no-pooling” model from McCartan et al. We’ll use Gibbs sampling for inference, which will also let us capture the uncertainty in our estimates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="reference/birdie.html">birdie</a></span><span class="op">(</span><span class="va">r_probs</span>, <span class="va">turnout</span> <span class="op">~</span> <span class="fu"><a href="reference/preproc.html">proc_zip</a></span><span class="op">(</span><span class="va">zip</span><span class="op">)</span>, data<span class="op">=</span><span class="va">pseudo_vf</span>, </span>
<span>             family<span class="op">=</span><span class="fu"><a href="reference/birdie-family.html">cat_dir</a></span><span class="op">(</span><span class="op">)</span>, algorithm<span class="op">=</span><span class="st">"gibbs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using weakly informative empirical Bayes prior for Pr(Y | R)</span></span>
<span><span class="co">#&gt; This message is displayed once every 8 hours.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Categorical-Dirichlet BIRDiE model</span></span>
<span><span class="co">#&gt; Formula: turnout ~ proc_zip(zip)</span></span>
<span><span class="co">#&gt;    Data: pseudo_vf</span></span>
<span><span class="co">#&gt; Number of obs: 5,000</span></span>
<span><span class="co">#&gt; Estimated distribution:</span></span>
<span><span class="co">#&gt;     white black  hisp asian  aian other</span></span>
<span><span class="co">#&gt; no  0.293  0.34 0.372 0.569 0.685 0.499</span></span>
<span><span class="co">#&gt; yes 0.707  0.66 0.628 0.431 0.315 0.501</span></span></code></pre></div>
<p>The <code><a href="reference/preproc.html">proc_zip()</a></code> function fills in missing ZIP codes, among other things. We can extract the estimated conditional distributions with <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>. We can also get updated BISG probabilities that additionally condition on turnout using <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code>. Additional functions allow us to extract a tidy version of our estimates (<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>) and visualize the estimated distributions (<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;         white     black      hisp     asian      aian     other</span></span>
<span><span class="co">#&gt; no  0.2934753 0.3403649 0.3720582 0.5687325 0.6847874 0.4994076</span></span>
<span><span class="co">#&gt; yes 0.7065247 0.6596351 0.6279418 0.4312675 0.3152126 0.5005924</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span><span class="co">#&gt;   pr_white pr_black pr_hisp pr_asian  pr_aian pr_other</span></span>
<span><span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   0.961   0.00349 0.0101  0.000523 0.00577    0.0195</span></span>
<span><span class="co">#&gt; 2   0.0765  0.893   0.00814 0.00102  0.00106    0.0207</span></span>
<span><span class="co">#&gt; 3   0.932   0.00542 0.0287  0.00538  0.000384   0.0286</span></span>
<span><span class="co">#&gt; 4   0.587   0.352   0.0260  0.000833 0.000783   0.0335</span></span>
<span><span class="co">#&gt; 5   0.945   0.00224 0.0219  0.00368  0.00334    0.0238</span></span>
<span><span class="co">#&gt; 6   0.528   0.324   0.0895  0.00379  0.00143    0.0538</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 3</span></span>
<span><span class="co">#&gt;    turnout race  estimate</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 no      white    0.293</span></span>
<span><span class="co">#&gt;  2 yes     white    0.707</span></span>
<span><span class="co">#&gt;  3 no      black    0.340</span></span>
<span><span class="co">#&gt;  4 yes     black    0.660</span></span>
<span><span class="co">#&gt;  5 no      hisp     0.372</span></span>
<span><span class="co">#&gt;  6 yes     hisp     0.628</span></span>
<span><span class="co">#&gt;  7 no      asian    0.569</span></span>
<span><span class="co">#&gt;  8 yes     asian    0.431</span></span>
<span><span class="co">#&gt;  9 no      aian     0.685</span></span>
<span><span class="co">#&gt; 10 yes     aian     0.315</span></span>
<span><span class="co">#&gt; 11 no      other    0.499</span></span>
<span><span class="co">#&gt; 12 yes     other    0.501</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p>A more detailed introduction to the method and software package can be found on the <a href="https://corymccartan.com/birdie/articles/birdie.html" class="external-link">Get Started</a> page.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=birdie" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/CoryMcCartan/birdie/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/CoryMcCartan/birdie/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing birdie</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Cory McCartan <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/CoryMcCartan/birdie/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/CoryMcCartan/birdie/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=redist" class="external-link"><img src="https://www.r-pkg.org/badges/version-last-release/birdie" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cory McCartan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
